KoM_the_gate_of_invocation_effect = {
	add_piety = -250
	trigger_event = KoM_goetia_events.1
	show_as_tooltip = {
		KoM_learn_random_true_name_demon_effect = yes
	}
}
KoM_learn_random_true_name_demon_effect = {
	random_list = {
		10 = { #Intrigue, Discover Secret of Target, Modifier(Scheme secrecy +10%), +5 Opportunities
			trigger = { NOT = { is_target_in_variable_list = { name = KoM_true_demon_names target = flag:bael_true_name } } }
			send_interface_message = {
				title = KoM_rite_the_gate_of_invocation
				KoM_the_gate_of_invocation_learn_demon_name_effect = { DEMON = bael }
			}
		}
		10 = { #Learning, Modifier(Innovation speed +20%), Give random Inspiration to target, Can lessen relation
			trigger = { NOT = { is_target_in_variable_list = { name = KoM_true_demon_names target = flag:amon_true_name } } }
			send_interface_message = {
				title = KoM_rite_the_gate_of_invocation
				KoM_the_gate_of_invocation_learn_demon_name_effect = { DEMON = amon }
			}
		}
		8 = { #Diplomacy, Modifier(Attractiveness Opinion +20), -50 stress, Modifier(-1 to all skills)
			trigger = { NOT = { is_target_in_variable_list = { name = KoM_true_demon_names target = flag:vapula_true_name } } }
			send_interface_message = {
				title = KoM_rite_the_gate_of_invocation
				KoM_the_gate_of_invocation_learn_demon_name_effect = { DEMON = vapula }
			}
		}
		8 = { #Martial, Increases success chance for next Hunt, Modifier(+6 prowess), Modifier(+6 advantage)
			trigger = { NOT = { is_target_in_variable_list = { name = KoM_true_demon_names target = flag:barbatos_true_name } } }
			send_interface_message = {
				title = KoM_rite_the_gate_of_invocation
				KoM_the_gate_of_invocation_learn_demon_name_effect = { DEMON = barbatos }
			}
		}
		6 = { #Learning, You will know who killed in your court, Modifier(-20% stress Gain), Heal depressed|-25 stress
			trigger = { NOT = { is_target_in_variable_list = { name = KoM_true_demon_names target = flag:gamigin_true_name } } }
			send_interface_message = {
				title = KoM_rite_the_gate_of_invocation
				KoM_the_gate_of_invocation_learn_demon_name_effect = { DEMON = gamigin }
			}
		}
		6 = { #Intrigue, Intrigue +1, Modifier(General Opinion +10), Gain strong hook on target
			trigger = { NOT = { is_target_in_variable_list = { name = KoM_true_demon_names target = flag:beleth_true_name } } }
			send_interface_message = {
				title = KoM_rite_the_gate_of_invocation
				KoM_the_gate_of_invocation_learn_demon_name_effect = { DEMON = beleth }
			}
		}
		4 = { #Learning, Learning +1, Modifier(Travel Safety +50), Modifier(+2 learning per piety)
			trigger = { NOT = { is_target_in_variable_list = { name = KoM_true_demon_names target = flag:astaroth_true_name } } }
			send_interface_message = {
				title = KoM_rite_the_gate_of_invocation
				KoM_the_gate_of_invocation_learn_demon_name_effect = { DEMON = astaroth }
			}
		}
		4 = { #Martial, Martial +1, Give to all Knights Modifier(+5 advantage), Give target Brave and Loyal
			trigger = { NOT = { is_target_in_variable_list = { name = KoM_true_demon_names target = flag:marchosias_true_name } } }
			send_interface_message = {
				title = KoM_rite_the_gate_of_invocation
				KoM_the_gate_of_invocation_learn_demon_name_effect = { DEMON = marchosias }
			}
		}
		2 = { #Diplomacy, Diplomacy +1, Modifier(-20 vassal opinion), Modifier(Control Gain -50%)
			trigger = { NOT = { is_target_in_variable_list = { name = KoM_true_demon_names target = flag:belial_true_name } } }
			send_interface_message = {
				title = KoM_rite_the_gate_of_invocation
				KoM_the_gate_of_invocation_learn_demon_name_effect = { DEMON = belial }
			}
		}
		2 = { #Stewardship, Stewardship +1, Modifier(+20 vassal opinion), Modifier(Control Gain +50%)
			trigger = { NOT = { is_target_in_variable_list = { name = KoM_true_demon_names target = flag:paimon_true_name } } }
			send_interface_message = {
				title = KoM_rite_the_gate_of_invocation
				KoM_the_gate_of_invocation_learn_demon_name_effect = { DEMON = paimon }
			}
		}
	}
}
KoM_the_gate_of_invocation_learn_demon_name_effect = {
	KoM_save_tooltip = { LOC = KoM_goetia_demon_$DEMON$ }
	custom_tooltip = {
		text = KoM_the_gate_of_invocation_learn_demon_name_effect
		add_to_variable_list = { name = KoM_true_demon_names target = flag:$DEMON$_true_name }
	}
}

KoM_the_lesser_conjurations_effect = {
	$TARGET$ = { save_scope_as = KoM_target }
	add_piety = -500
	trigger_event = KoM_goetia_events.2
	custom_tooltip = KoM_rite_the_lesser_conjurations_effect
}
KoM_hunt_sighting_county_province_effect = {
	if = {
		limit = { is_landed = no }
		domicile.domicile_location.county ?= {
			if = {
				limit = { hunt_activity_recent_hunt_sighting_trigger = no }
				add_to_list = sighting_counties
			}
			if = { # Estate owners cannot move to hunt
				limit = { root = { is_landless_adventurer = yes } }
				every_neighboring_county = {
					limit = { hunt_activity_recent_hunt_sighting_trigger = no }
					add_to_list = sighting_counties
				}
			}
		}
	}
	else = {
		every_sub_realm_county = {
			limit = { hunt_activity_recent_hunt_sighting_trigger = no }
			add_to_list = sighting_counties
		}
	}
	random_in_list = {
		list = sighting_counties
		limit = { hunt_activity_recent_hunt_sighting_trigger = no }
		weight = {
			base = 1
			modifier = {
				add = {
					value = 0
					subtract = development_level
					divide = 4
				}
			}
			modifier = {
				county_has_province_with_terrain = {
					terrain = taiga
					terrain = forest
					terrain = mountains
					terrain = jungle
				}
				add = 10
			}
		}
		save_scope_as = sighting_county
		random_county_province = {
			weight = {
				base = 1
				hunt_activity_sighting_terrain_modifier = yes
				hunt_activity_sighting_building_modifier = { PROVINCE = this }
				hunt_activity_game_building_modifier = { PROVINCE = this }
			}
			save_scope_as = sighting_province
		}
	}
}
KoM_the_lesser_conjurations_real_effect = {
	save_scope_as = KoM_caster
	switch = {
		trigger = $DEMON$
		flag:bael = {
			scope:KoM_target ?= {
				custom_tooltip = KoM_rite_the_lesser_conjurations_effect1
				random_secret = {
					limit = { NOT = { is_known_by = scope:KoM_caster } }
					reveal_to = scope:KoM_caster
				}
			}
		}
		flag:amon = {
			add_character_modifier = { modifier = KoM_amon_guidance_modifier years = 5 }
		}
		flag:vapula = {
			add_character_modifier = { modifier = KoM_vapula_guidance_modifier years = 5 }
		}
		flag:barbatos = {
			random_list = {
				5 = {
					hidden_effect = {
						hunt_activity_sighting_master_effect = { TYPE = hunter }
						# Save county
						KoM_hunt_sighting_county_province_effect = yes
						# Save sighting
						scope:sighting_county = {
							hunt_activity_falconry_game_effect = { PROVINCE = scope:sighting_province }
							# Create new sighting
							hunt_create_sighting_effect = {
								TYPE = standard
								ANIMAL = var:animal_type
								OWNER = scope:KoM_target
							}
						}
					}
					send_interface_message = {
						title = KoM_goetia_events.2.a
						show_as_tooltip = { scope:sighting_county ?= { add_county_modifier = hunt_sighting_standard_modifier } }
					}
				}
				5 = {
					hidden_effect = {
						hunt_activity_sighting_master_effect = { TYPE = hunter }
						# Save county
						KoM_hunt_sighting_county_province_effect = yes
						# Save sighting
						scope:sighting_county = {
							hunt_activity_falconry_game_effect = { PROVINCE = scope:sighting_province }
							# Create new sighting
							hunt_create_sighting_effect = {
								TYPE = dangerous
								ANIMAL = var:animal_type
								OWNER = scope:KoM_target
							}
						}
					}
					send_interface_message = {
						title = KoM_goetia_events.2.a
						show_as_tooltip = { scope:sighting_county ?= { add_county_modifier = hunt_sighting_dangerous_modifier } }
					}
				}
				10 = {
					hidden_effect = {
						hunt_activity_sighting_master_effect = { TYPE = falconer }
						# Save county
						KoM_hunt_sighting_county_province_effect = yes
						# Save sighting
						scope:sighting_county = {
							hunt_activity_falconry_game_effect = { PROVINCE = scope:sighting_province }
							# Create new sighting
							hunt_create_sighting_effect = {
								TYPE = falconry
								ANIMAL = var:animal_type
								OWNER = scope:KoM_target
							}
						}
					}
					send_interface_message = {
						title = KoM_goetia_events.2.a
						show_as_tooltip = { scope:sighting_county ?= { add_county_modifier = hunt_sighting_falconry_modifier } }
					}
				}
				1 = {
					hidden_effect = {
						hunt_activity_sighting_master_effect = { TYPE = hunter }
						# Save county
						KoM_hunt_sighting_county_province_effect = yes
						# Save sighting
						scope:sighting_county = {
							hunt_activity_falconry_game_effect = { PROVINCE = scope:sighting_province }
							# Create new sighting
							hunt_create_sighting_effect = {
								TYPE = legendary
								ANIMAL = var:animal_type
								OWNER = scope:KoM_target
							}
						}
					}
					send_interface_message = {
						title = KoM_goetia_events.2.a
						show_as_tooltip = { scope:sighting_county ?= { add_county_modifier = hunt_sighting_legendary_modifier } }
					}
				}
			}

		}
		flag:gamigin = {
			scope:KoM_target ?= {
				custom_tooltip = KoM_rite_the_lesser_conjurations_effect2
				every_secret = {
					limit = {
						NOT = { is_known_by = scope:KoM_caster }
						secret_type = secret_murder
					}
					reveal_to = scope:KoM_caster
				}
			}
		}
		flag:beleth = { add_intrigue_skill = 1 }
		flag:astaroth = { add_learning_skill = 1 }
		flag:marchosias = { add_martial_skill = 1 }
		flag:belial = { add_diplomacy_skill = 1 }
		flag:paimon = { add_stewardship_skill = 1 }
	}
}

KoM_the_seventy_two_gates_effect = {
	$TARGET$ = { save_scope_as = KoM_target }
	add_piety = -750
	trigger_event = KoM_goetia_events.3
	custom_tooltip = KoM_rite_the_seventy_two_gates_effect
}
KoM_the_seventy_two_gates_real_effect = {
	switch = {
		trigger = $DEMON$
		flag:bael = {
			scope:KoM_target ?= {
				add_character_modifier = { modifier = KoM_bael_influence_modifier years = 10 }
			}
		}
		flag:amon = {
			scope:KoM_target ?= {
				if = { limit = { has_ep1_dlc_trigger = yes }
					random_list = {
						1 = { create_inspiration = book_inspiration custom_tooltip = inspire_interaction_book }
						1 = { create_inspiration = weaver_inspiration custom_tooltip = inspire_interaction_weaver }
						1 = { create_inspiration = adventure_inspiration custom_tooltip = inspire_interaction_adventure }
						1 = { create_inspiration = artisan_inspiration custom_tooltip = inspire_interaction_artisan }
						1 = { create_inspiration = smith_inspiration custom_tooltip = inspire_interaction_smith }
						1 = { create_inspiration = alchemy_inspiration custom_tooltip = inspire_interaction_alchemy }
						1 = { create_inspiration = armor_inspiration custom_tooltip = inspire_interaction_armor }
						1 = { create_inspiration = weapon_inspiration custom_tooltip = inspire_interaction_weapon }
					}
				}
				add_character_modifier = { modifier = KoM_amon_influence_modifier years = 10 }
			}
		}
		flag:vapula = {
			scope:KoM_target ?= {
				add_stress = -50
			}
		}
		flag:barbatos = {
			scope:KoM_target ?= {
				add_character_modifier = { modifier = KoM_barbatos_influence_modifier years = 10 }
			}

		}
		flag:gamigin = {
			scope:KoM_target ?= {
				add_character_modifier = { modifier = KoM_gamigin_influence_modifier years = 10 }
			}
		}
		flag:beleth = {
			scope:KoM_target ?= {
				add_character_modifier = { modifier = KoM_beleth_influence_modifier years = 10 }
			}
		}
		flag:astaroth = {
			scope:KoM_target ?= {
				add_character_modifier = { modifier = KoM_astaroth_influence_modifier years = 10 }
			}
		}
		flag:marchosias = {
			scope:KoM_target ?= {
				every_knight = {
					add_character_modifier = { modifier = KoM_marchosias_influence_modifier years = 10 }
				}
			}
		}
		flag:belial = {
			scope:KoM_target ?= {
				add_character_modifier = { modifier = KoM_belial_influence_modifier years = 10 }
			}
		}
		flag:paimon = {
			scope:KoM_target ?= {
				add_character_modifier = { modifier = KoM_paimon_influence_modifier years = 10 }
			}
		}
	}
}

KoM_the_royal_theurgy_of_solomon_effect = {
	$TARGET$ = { save_scope_as = KoM_target }
	add_piety = -1000
	remove_short_term_gold = 100
	trigger_event = KoM_goetia_events.4
	custom_tooltip = KoM_rite_the_royal_theurgy_of_solomon_effect
}
KoM_the_royal_theurgy_of_solomon_real_effect = {
	switch = {
		trigger = $DEMON$
		flag:bael = {
			scope:KoM_target ?= {
				custom_tooltip = KoM_rite_the_royal_theurgy_of_solomon_effect1
				every_scheme = { change_opportunities = 5 }
			}
		}
		flag:amon = {
			scope:KoM_target ?= {
				custom_tooltip = KoM_rite_the_royal_theurgy_of_solomon_effect2
				KoM_downgrade_relation_effect = { CHARACTER = ROOT }
			}
		}
		flag:vapula = {
			scope:KoM_target ?= {
				add_character_modifier = { modifier = KoM_vapula_command_modifier years = 5 }
			}
		}
		flag:barbatos = {
			scope:KoM_target ?= {
				add_character_modifier = { modifier = KoM_barbatos_command_modifier years = 5 }
			}
		}
		flag:gamigin = {
			scope:KoM_target ?= {
				KoM_remove_trait_effect = { TRAIT = depressed_1 }
				KoM_remove_trait_effect = { TRAIT = depressed_genetic }
				add_stress = -25
			}
		}
		flag:beleth = {
			add_hook = {
				type = strong_favor_hook
				target = scope:KoM_target
			}
		}
		flag:astaroth = {
			scope:KoM_target ?= {
				add_character_modifier = { modifier = KoM_astaroth_command_modifier years = 5 }
			}
		}
		flag:marchosias = {
			scope:KoM_target ?= {
				KoM_remove_trait_effect = { TRAIT = craven }
				KoM_remove_trait_effect = { TRAIT = disloyal }
				add_trait = brave
				add_trait = loyal
			}
		}
		flag:belial = {
			scope:KoM_target ?= {
				add_character_modifier = { modifier = KoM_belial_command_modifier years = 5 }
			}
		}
		flag:paimon = {
			scope:KoM_target ?= {
				add_character_modifier = { modifier = KoM_paimon_command_modifier years = 5 }
			}
		}
	}
}

KoM_the_great_work_of_unification_effect = {
	send_interface_message = {
		title = KoM_rite_the_great_work_of_unification
		add_piety = -1000
		remove_short_term_gold = 200
		$TARGET$ = {
			every_character_trait = {
				limit = {
					OR = {
						has_trait_category = personality
						has_trait_category = education
					}
				}
				save_scope_as = this_trait
				PREV = { remove_trait = scope:this_trait }
			}
			add_trait_force_tooltip = possessed_1
			if = {
				limit = { has_any_nickname = yes }
				remove_nickname = yes
			}

		}
		switch = {
			trigger = $DEMON$
			flag:bael = {
				$TARGET$ = {
					add_trait_force_tooltip = callous
					add_trait_force_tooltip = sadistic
					add_trait_force_tooltip = deceitful
					add_trait_force_tooltip = education_intrigue_4
					KoM_the_great_work_of_unification_skill_effect = { DIPLOMACY = 4 MARTIAL = 5 STEWARDSHIP = 3 INTRIGUE = 10 LEANING = 4 }
					change_first_name = "KoM_goetia_demon_bael_name"
				}
			}
			flag:amon = {
				$TARGET$ = {
					add_trait_force_tooltip = calm
					add_trait_force_tooltip = patient
					add_trait_force_tooltip = callous
					add_trait_force_tooltip = education_learning_4
					KoM_the_great_work_of_unification_skill_effect = { DIPLOMACY = 6 MARTIAL = 6 STEWARDSHIP = 6 INTRIGUE = 0 LEANING = 10 }
					change_first_name = "KoM_goetia_demon_amon_name"
				}
			}
			flag:vapula = {
				$TARGET$ = {
					add_trait_force_tooltip = gregarious
					add_trait_force_tooltip = lustful
					add_trait_force_tooltip = lazy
					add_trait_force_tooltip = education_diplomacy_4
					KoM_the_great_work_of_unification_skill_effect = { DIPLOMACY = 10 MARTIAL = 1 STEWARDSHIP = 4 INTRIGUE = 2 LEANING = 4 }
					change_first_name = "KoM_goetia_demon_vapula_name"
				}
			}
			flag:barbatos = {
				$TARGET$ = {
					add_trait_force_tooltip = brave
					add_trait_force_tooltip = diligent
					add_trait_force_tooltip = callous
					add_trait_force_tooltip = education_martial_4
					KoM_the_great_work_of_unification_skill_effect = { DIPLOMACY = 2 MARTIAL = 10 STEWARDSHIP = 3 INTRIGUE = 6 LEANING = 3 }
					change_first_name = "KoM_goetia_demon_barbatos_name"
				}
			}
			flag:gamigin = {
				$TARGET$ = {
					add_trait_force_tooltip = patient
					add_trait_force_tooltip = eccentric
					add_trait_force_tooltip = cynical
					add_trait_force_tooltip = education_stewardship_4
					KoM_the_great_work_of_unification_skill_effect = { DIPLOMACY = 6 MARTIAL = 2 STEWARDSHIP = 10 INTRIGUE = 2 LEANING = 3 }
					change_first_name = "KoM_goetia_demon_gamigin_name"
				}
			}
			flag:beleth = {
				$TARGET$ = {
					add_trait_force_tooltip = callous
					add_trait_force_tooltip = deceitful
					add_trait_force_tooltip = arbitrary
					add_trait_force_tooltip = education_intrigue_5
					KoM_the_great_work_of_unification_skill_effect = { DIPLOMACY = 6 MARTIAL = 6 STEWARDSHIP = 6 INTRIGUE = 15 LEANING = 6 }
					change_first_name = "KoM_goetia_demon_beleth_name"
				}
			}
			flag:astaroth = {
				$TARGET$ = {
					add_trait_force_tooltip = calm
					add_trait_force_tooltip = patient
					add_trait_force_tooltip = cynical
					add_trait_force_tooltip = education_learning_5
					KoM_the_great_work_of_unification_skill_effect = { DIPLOMACY = 6 MARTIAL = 6 STEWARDSHIP = 6 INTRIGUE = 6 LEANING = 15 }
					change_first_name = "KoM_goetia_demon_astaroth_name"
				}
			}
			flag:marchosias = {
				$TARGET$ = {
					add_trait_force_tooltip = brave
					add_trait_force_tooltip = wrathful
					add_trait_force_tooltip = ambitious
					add_trait_force_tooltip = education_martial_5
					KoM_the_great_work_of_unification_skill_effect = { DIPLOMACY = 6 MARTIAL = 15 STEWARDSHIP = 6 INTRIGUE = 6 LEANING = 6 }
					change_first_name = "KoM_goetia_demon_marchosias_name"
				}
			}
			flag:belial = {
				$TARGET$ = {
					add_trait_force_tooltip = arrogant
					add_trait_force_tooltip = gregarious
					add_trait_force_tooltip = ambitious
					add_trait_force_tooltip = education_diplomacy_5
					KoM_the_great_work_of_unification_skill_effect = { DIPLOMACY = 15 MARTIAL = 6 STEWARDSHIP = 6 INTRIGUE = 6 LEANING = 6 }
					change_first_name = "KoM_goetia_demon_belial_name"
				}
			}
			flag:paimon = {
				$TARGET$ = {
					add_trait_force_tooltip = diligent
					add_trait_force_tooltip = patient
					add_trait_force_tooltip = stubborn
					add_trait_force_tooltip = education_stewardship_5
					KoM_the_great_work_of_unification_skill_effect = { DIPLOMACY = 6 MARTIAL = 6 STEWARDSHIP = 15 INTRIGUE = 6 LEANING = 6 }
					change_first_name = "KoM_goetia_demon_paimon_name"
				}
			}
		}
	}
	trigger_event = { on_action = KoM_after_rite }
}
KoM_the_great_work_of_unification_skill_effect = {
	add_diplomacy_skill = $DIPLOMACY$
	add_martial_skill = $MARTIAL$
	add_stewardship_skill = $STEWARDSHIP$
	add_intrigue_skill = $INTRIGUE$
	add_learning_skill = $LEANING$
}