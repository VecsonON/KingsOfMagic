KoM_npc = {
	incapacitating = yes
	disables_combat_leadership = yes
	shown_in_ruler_designer = no
	immortal = yes
	shown_in_encyclopedia = no
	inheritance_blocker = all
	claim_inheritance_blocker = all
	can_have_children = no
	ai_energy = -100
	icon = hideout.dds
}

KoM_magus = {
	flag = mage

	name = {
		first_valid = {
			triggered_desc = {
				trigger = { NOT = { exists = this } }
				desc = trait_KoM_magus
			}
			triggered_desc = {
				trigger = {
					faith = { has_doctrine_parameter = witchcraft_illegal }
					NOT = { is_local_player = yes }
				}
				desc = trait_witch
			}
			desc = trait_KoM_magus
		}
	}

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { NOT = { exists = this } }
				desc = trait_KoM_magus_desc
			}
			triggered_desc = {
				trigger = {
					faith = { has_doctrine_parameter = witchcraft_illegal }
					NOT = { is_local_player = yes }
				}
				desc = trait_KoM_witch_desc
			}
			desc = trait_KoM_magus_desc
		}
	}

	triggered_opinion = {
		parameter = witchcraft_illegal
		opinion_modifier = witchcraft_crime
		ignore_opinion_value_if_same_trait = yes
	}

	triggered_opinion = {
		parameter = witchcraft_shunned
		opinion_modifier = witchcraft_intolerant
		ignore_opinion_value_if_same_trait = yes
	}

	track = {
		10 = { KoM_terrain_type_goetia_novice_cancel_negative_supply = yes }
		25 = { KoM_terrain_type_goetia_apprentice_cancel_negative_supply = yes }
		50 = { KoM_terrain_type_goetia_adept_cancel_negative_supply = yes }
		75 = { KoM_terrain_type_goetia_expert_cancel_negative_supply = yes }
		100 = { KoM_terrain_type_goetia_master_cancel_negative_supply = yes }
	}

	icon = magus.dds
}
KoM_thaumaturge = {
	flag = mage

	name = {
		first_valid = {
			triggered_desc = {
				trigger = { NOT = { exists = this } }
				desc = trait_KoM_thaumaturge
			}
			triggered_desc = {
				trigger = {
					faith = { has_doctrine_parameter = witchcraft_illegal }
					NOT = { is_local_player = yes }
				}
				desc = trait_witch
			}
			desc = trait_KoM_thaumaturge
		}
	}

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { NOT = { exists = this } }
				desc = trait_KoM_thaumaturge_desc
			}
			triggered_desc = {
				trigger = {
					faith = { has_doctrine_parameter = witchcraft_illegal }
					NOT = { is_local_player = yes }
				}
				desc = trait_KoM_witch_desc
			}
			desc = trait_KoM_thaumaturge_desc
		}
	}

	triggered_opinion = {
		parameter = witchcraft_illegal
		opinion_modifier = witchcraft_crime
		ignore_opinion_value_if_same_trait = yes
	}

	triggered_opinion = {
		parameter = witchcraft_shunned
		opinion_modifier = witchcraft_intolerant
		ignore_opinion_value_if_same_trait = yes
	}

	track = {
		10 = {
			KoM_terrain_type_thaumaturgy_declaration_persona_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_confirmation_voluntas_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_recuperare_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_claritudo_cancel_negative_supply = yes
		}
		25 =  {
			KoM_terrain_type_thaumaturgy_declaration_res_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_confirmation_nuntius_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_sarcio_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_damnum_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_celeritas_cancel_negative_supply = yes
		}
		50 =  {
			KoM_terrain_type_thaumaturgy_confirmation_angelus_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_duo_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_fortitudo_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_stabilitas_cancel_negative_supply = yes
		}
		75 =  {
			KoM_terrain_type_thaumaturgy_declaration_locus_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_opinio_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_anima_cancel_negative_supply = yes
		}
		100 =  {
			KoM_terrain_type_thaumaturgy_confirmation_deus_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_tres_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_scientia_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_melius_cancel_negative_supply = yes
			KoM_terrain_type_thaumaturgy_action_peius_cancel_negative_supply = yes
		}
	}

	icon = thaumaturge.dds
}
KoM_theurgist = {
	flag = mage

	track = {
		10 = { KoM_terrain_type_theurgy_novice_cancel_negative_supply = yes }
		25 = { KoM_terrain_type_theurgy_apprentice_cancel_negative_supply = yes }
		50 = { KoM_terrain_type_theurgy_adept_cancel_negative_supply = yes }
		75 = { KoM_terrain_type_theurgy_expert_cancel_negative_supply = yes }
		100 = { KoM_terrain_type_theurgy_master_cancel_negative_supply = yes }
	}

	icon = theurgist.dds
}
KoM_alchemist = {
	flag = mage

	name = {
		first_valid = {
			triggered_desc = {
				trigger = { NOT = { exists = this } }
				desc = trait_KoM_alchemist
			}
			triggered_desc = {
				trigger = {
					faith = { has_doctrine_parameter = witchcraft_illegal }
					NOT = { is_local_player = yes }
				}
				desc = trait_witch
			}
			desc = trait_KoM_alchemist
		}
	}

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { NOT = { exists = this } }
				desc = trait_KoM_alchemist_desc
			}
			triggered_desc = {
				trigger = {
					faith = { has_doctrine_parameter = witchcraft_illegal }
					NOT = { is_local_player = yes }
				}
				desc = trait_KoM_witch_desc
			}
			desc = trait_KoM_alchemist_desc
		}
	}

	triggered_opinion = {
		parameter = witchcraft_illegal
		opinion_modifier = witchcraft_crime
		ignore_opinion_value_if_same_trait = yes
	}

	triggered_opinion = {
		parameter = witchcraft_shunned
		opinion_modifier = witchcraft_intolerant
		ignore_opinion_value_if_same_trait = yes
	}

	track = {
		10 = {
			KoM_terrain_type_alchemy_elixir_of_ash_and_salt_cancel_negative_supply = yes
			KoM_terrain_type_alchemy_draught_of_still_waters_cancel_negative_supply = yes
			KoM_terrain_type_alchemy_infusion_of_lead_cancel_negative_supply = yes
		}
		25 =  {
			KoM_terrain_type_alchemy_elixir_of_ash_and_salt_cancel_negative_supply = yes
			KoM_terrain_type_alchemy_dew_of_morning_stars_cancel_negative_supply = yes
			KoM_terrain_type_alchemy_aqua_sapientiae_cancel_negative_supply = yes
		}
		50 =  {
			KoM_terrain_type_alchemy_elixir_of_the_solar_mind_cancel_negative_supply = yes
			KoM_terrain_type_alchemy_draught_of_the_inner_flame_cancel_negative_supply = yes
			KoM_terrain_type_alchemy_tears_of_the_red_king_cancel_negative_supply = yes
		}
		75 =  {
			KoM_terrain_type_alchemy_blood_of_the_phoenix_cancel_negative_supply = yes
			KoM_terrain_type_alchemy_elixir_rubedo_cancel_negative_supply = yes
			KoM_terrain_type_alchemy_homunculi_cancel_negative_supply = yes
		}
		100 =  {
			KoM_terrain_type_alchemy_elixir_vitae_cancel_negative_supply = yes
			KoM_terrain_type_alchemy_aurum_astralis_cancel_negative_supply = yes
			KoM_terrain_type_alchemy_the_philosophers_stone_cancel_negative_supply = yes
		}
	}

	icon = alchemist.dds
}
KoM_daoshi = {
	flag = mage

	KoM_terrain_type_taoism_the_neidan_meditation_cancel_negative_supply = yes

	track = {
		10 = { KoM_terrain_type_taoism_qingqiu_huifu_yishi_cancel_negative_supply = yes }
		25 = { KoM_terrain_type_taoism_qiqiu_pingjing_xinling_de_yishi_cancel_negative_supply = yes }
		50 = { KoM_terrain_type_taoism_qifu_yishi_cancel_negative_supply = yes }
		75 = { KoM_terrain_type_taoism_qiqiu_mingri_zhishi_de_yishi_cancel_negative_supply = yes }
		100 = { KoM_terrain_type_taoism_qingqiu_kuaisu_luxing_de_yishi_cancel_negative_supply = yes }
	}

	icon = daoshi.dds
}
KoM_onmyoji = {
	flag = mage

	track = {
		10 = { }
		25 = { }
		50 = { }
		75 = { }
		100 = { }
	}

	icon = onmyoji.dds
}

### TAOISM ###

KoM_lianjing_huaqi = {
	flag = taoism_stage
	shown_in_ruler_designer = no

	track = {
		25 = {
			health = 1
			prowess_no_portrait = 3
			stress_gain_mult = -0.02
		}
		50 = {
			health = 1
			prowess_no_portrait = 3
			stress_gain_mult = -0.02
		}
		75 = {
			health = 1
			prowess_no_portrait = 3
			stress_gain_mult = -0.03
		}
		100 = {
			health = 1
			prowess_no_portrait = 3
			stress_gain_mult = -0.03
		}
	}

	icon = lianjing_huaqi.dds
}
KoM_lianqi_huashen = {
	flag = taoism_stage
	shown_in_ruler_designer = no

	health = 4
	prowess_no_portrait = 12
	stress_gain_mult = -0.1
	no_prowess_loss_from_age = yes

	track = {
		25 = {
			health = 2
			prowess_no_portrait = 4
			stress_gain_mult = -0.05
			life_expectancy = 25
		}
		50 = {
			health = 2
			prowess_no_portrait = 4
			stress_gain_mult = -0.05
			life_expectancy = 25
		}
		75 = {
			health = 2
			prowess_no_portrait = 4
			stress_gain_mult = -0.05
			life_expectancy = 25
		}
		100 = {
			health = 2
			prowess_no_portrait = 4
			stress_gain_mult = -0.05
			life_expectancy = 25
		}
	}

	icon = lianqi_huashen.dds
}
KoM_lianshen_huanxu = {
	flag = taoism_stage
	shown_in_ruler_designer = no

	health = 10
	prowess_no_portrait = 28
	stress_gain_mult = -0.3
	life_expectancy = 100
	no_prowess_loss_from_age = yes

	track = {
		25 = {
			health = 2
			prowess_no_portrait = 6
			stress_gain_mult = -0.1
			life_expectancy = 100
		}
		50 = {
			health = 2
			prowess_no_portrait = 7
			stress_gain_mult = -0.1
			life_expectancy = 250
		}
		75 = {
			health = 3
			prowess_no_portrait = 8
			stress_gain_mult = -0.1
			life_expectancy = 250
		}
		100 = {
			health = 3
			prowess_no_portrait = 10
			stress_gain_mult = -0.1
			life_expectancy = 300
		}
	}

	icon = lianshen_huanxu.dds
}
KoM_xian = {
	flag = taoism_stage
	shown_in_ruler_designer = no

	health = 20
	prowess_no_portrait = 60
	stress_gain_mult = -0.7
	life_expectancy = 1000
	no_prowess_loss_from_age = yes

	immortal = yes
	# Dummy flags — just here for loc really.
	flag = is_immortal
	flag = immortal_visuals
	flag = immortal_fertility
	flag = immortal_incapability
	long_reign_bonus_mult = -1000
	no_prowess_loss_from_age = yes

	icon = xian.dds
}